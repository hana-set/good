---
title:  "waterfall 차트"
excerpt: "주식에서 보는 증감차트"
categories:
  - Tab_View
tags:
  - 3
last_modified_at: 2021-04-10

use_math : true
---

# <center><font size="16"> 워터풀 차트 </font></center>

워터풀 차트는, 값의 증감을 주식처럼 차트로 알아볼 수 있는 그래프이다. 시간이 지남에 따라, 어떠한 경향에 따라 값이 변하는지 알 수 있어 매우 편리하다.

먼저 아래와 같이 시간과, 그에따른 수익을 시각화 하고 싶다고 하자. 아래의 경우도 시간에 따른 수익을 시각화 한것이긴 하지만, 눈에 확 들어오지 않는다. 이를 waterfall 차트를 통해서 한눈에 보이도록 수정해보자.

![png](/assets/images/Tab_Vis/5_1.PNG)

아래와 같이 Running Total 로 유형을 수정한다. 

![png](/assets/images/Tab_Vis/5_2.PNG)

그러고 나서, 막대그래프를 보면 누적값이 나오게 된다. 누적 매출을 볼 수 있어서 아까보다는 조금 나은거 같지만 아직도 한눈에 보이지는 않는다.

![png](/assets/images/Tab_Vis/5_3.PNG)

그래서 아래 그림과 같이 간트차트를 그리고, 

![png](/assets/images/Tab_Vis/5_4.PNG)

수익에 대해 -[profit] 이라는 새로운 변수를 정의한다. 

![png](/assets/images/Tab_Vis/5_5.PNG)

그 이후 Size 에 이 카드를 넣게되면 아래와 같이 형성되게 된다. 왜 이렇게 되었을까? 우리는 간트차트를 이용하여 running total. 즉 그 시점의 매출 합을 표현하였었다. 하지만 우리가 알고싶은것은 매출 합 뿐만 아니라, 그 월에 어느정도의 수익을 올렸는지도 알고싶다. 

그래서 수익을 통해 막대로 얼마나 수익을 올렸는지를 표현할 것이다. 이를 하기 위해서는 수익 변수의 크기가 막대 크기가 되야한다. 하지만 이때 그냥 profit 을 간차트의 size 에 바로 넣게된다면 안된다.

12월의 예시를 생각해보자. 12월까지의 매출합 = 200 이고, 그 시점의 profit = 30 이라고 하자.12월의 경우 우리가 원하는 그래프는 170 ~ 200 까지의 막대이다.  하지만 profit 을 사이즈에 그냥 넣게되면 양수값인 경우 막대가 위로 늘어나기 떄문에 200~230 을 표현하게 된다. 즉 당월의 이익을 중복해서 계산해버리는것! 그러므로 - 값을 넣게된다.

![png](/assets/images/Tab_Vis/5_6.PNG)

이제 색깔을 통해서 이익과 손해를 구분하게 하도록 하겠다. 아래와 같이 profit 이 0보다 크면 상승 , 나머지 경우는 하락으로 표시하자.

![png](/assets/images/Tab_Vis/5_7.PNG)

그 이후 color 에 위 변수를 넣게되면 상승과 하락이 정확하게 구분된다.

![png](/assets/images/Tab_Vis/5_8.PNG)

이제 이중축과 간트차트를 이용하여 겹쳐넣으면 아래와 같이 막대그래프가 잘 나오게 된다.

![png](/assets/images/Tab_Vis/5_9.PNG)



